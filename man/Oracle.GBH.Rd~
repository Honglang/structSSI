\name{Oracle.GBH}
\alias{Oracle.GBH}

\title{
Oracle Group Benjamini-Hochberg Correction
}
\description{
Performs the Group Benjamini-Hochberg procedure when the true proportion
of null hypotheses is known within each group.
}
\usage{
Oracle.GBH(unadj.p, groups, pi.groups, alpha)
}

\arguments{
  \item{unadj.p}{
    A vector of the unadjusted p-values resulting from a multiple
  testing experiment.
}
\item{groups}{
    A vector of the same length as the vector of unadjusted p-values,
  where an 'i' in the jth coordinate indicates that the jth unadjusted
  p-values in \code{unadj.p} belongs to group i.
}
  \item{pi.groups}{
    A vector of the known proportions of true null hypotheses within
  each of the groups. The ith element of this vector is the proportion
  of null hypotheses in group i within the groups argument.
}
  \item{alpha}{
    The level that we are attempting to control the FDR at.
}
}
\details{
This method is described in the paper by Hu, Zhou, and Zhao 2011.
}
\value{

  A list where the first element consists of the sorted unadjusted
  p-values with their corresponding hypotheses and the second element
  cosists of the sorted Group Benjamini-Hochberg adjusted p-values with
  their corresponding hypotheses labels.


}
\references{
The paper by Hu, Zhou, and Zhao, 2011.
}
\author{
Kris Sankaran
}

\seealso{
\code{estimatePi0}
}
\examples{

# A very simple example, with only 5 hypotheses.

unadjp <- c(0.002, 0.1, 0.001, 0.01, 0.4)
names(unadjp) <- paste("hyp", 1:5)
groups <- c(1, 2, 1, 2, 2)

# Say we know goup 1 has pi_0,1 = 0.3 and pi_0,2 = 0.9

Oracle.GBH(unadjp, c(1, 1, 2, 2, 1), c(0.3, 0.9), 0.05)

}

\keyword{ ~htest }

